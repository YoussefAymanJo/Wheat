<!DOCTYPE html>
<html>
<head>
<title>Wheat Rust Race Prediction Filter</title>

<style>
body{font-family:Calibri;background:#f7f7f7;padding:30px;}
h2{color:#003366;}
select{
    width:60%;padding:8px;margin:8px 0;font-size:16px;
    border-radius:4px;border:1px solid #666;
}
.filter-title{font-weight:bold;color:#004c7a;margin-top:15px;}
.result-box{
    background:white;width:60%;margin-top:20px;padding:15px;
    border-left:5px solid #006699;border-radius:5px;
}
.result{background:#eaf4ff;margin:10px 0;padding:10px;border-radius:5px;}
.home-btn{display:inline-flex;align-items:center;gap:6px; background:#ffd166;}
.home-icon{width:18px;height:18px;display:block;}
.home-btn:hover{opacity:0.85;}
</style>
<link rel="stylesheet" href="lib/bootstrap-icons.css">
</head>

<body>
<a href="../PredictionWheatGene App.html" class="home-btn" style="margin-right:12px;padding:8px 14px;background:#ffd166;color:#000;text-decoration:none;border-radius:8px;font-weight:600;"><i class="bi bi-house"></i>Home</a>
<h2>Wheat Rust Disease Race Prediction Dashboard</h2>

<div class="filter-title">Filter by Yellow Rust Races (P. striiformis)</div>
<select id="Yfilter"  onchange="predict()"> <option value="">-- Select Race Yr--</option></select>

<div class="filter-title">Filter by Leaf Rust Races (P. triticina)</div>
<select id="Lfilter"  onchange="predict()"> <option value="">-- Select Race Lr--</option></select>

<div class="filter-title">Filter by Stem Rust Races (P. graminis)</div>
<select id="Sfilter"  onchange="predict()"> <option value="">-- Select Race Sr--</option></select>

<div class="filter-title">Filter by Location (Governorate)</div>
<select id="locationFilter" onchange="predict()">
    <option value="">-- Any Location --</option>
</select>

<div class="result-box" id="output"></div>

<script>
const DB=[
{cv:"Misr 3", YrR:["TTTTT","PstS2"], LrR:["BBG/BN","THT/TT"], SrR:["TTKSK","TTTSK"], loc:"Kafr El-Sheikh", level:"High"},
{cv:"Misr 4", YrR:["PstS2","PstS13"], LrR:["THT/TT","MHT/TT"], SrR:["TTKST","TRTTF"], loc:"Giza", level:"High"},
{cv:"Misr 5", YrR:["PstS2","PstS8"], LrR:["MHT/TT","THT/TT"], SrR:["TTKSK"], loc:"Beni Suef", level:"Moderate"},
{cv:"Misr 6", YrR:["PstS2","PstS13"], LrR:["BBG/BN"], SrR:["TTKST"], loc:"Kafr El-Sheikh", level:"High"},
{cv:"Misr 7", YrR:["PstS2"], LrR:["THT/TT"], SrR:["TTKSK","TTTTF"], loc:"Sohag", level:"High"},
{cv:"Sids 13", YrR:["PstS8"], LrR:["BBG/BN"], SrR:["TRTTF"], loc:"Beni Suef", level:"Moderate"},
{cv:"Sids 14", YrR:["PstS13"], LrR:["MHT/TT"], SrR:["TTTSK"], loc:"Beni Suef", level:"Moderate"},
{cv:"Sids 15", YrR:["PstS2"], LrR:["BBG/BN","THT/TT"], SrR:["TRTTF"], loc:"Minia", level:"Moderate to High"},
{cv:"Sakha 94", YrR:["PstS13"], LrR:["THT/TT"], SrR:["TTKSK"], loc:"Kafr El-Sheikh", level:"Moderate"},
{cv:"Sakha 95", YrR:["PstS2","PstS8"], LrR:["BBG/BN"], SrR:["TTTSK"], loc:"Kafr El-Sheikh", level:"High"},
{cv:"Sakha 96", YrR:["PstS2"], LrR:["MHT/TT"], SrR:["TTKST"], loc:"Kafr El-Sheikh", level:"High"},
{cv:"Sakha 97", YrR:["PstS2","PstS13"], LrR:["THT/TT"], SrR:["TTTSK"], loc:"Gharbia", level:"High"},
{cv:"Shandweel 1", YrR:["PstS8"], LrR:["BBG/BN"], SrR:["TRTTF"], loc:"Sohag", level:"Moderate"},
{cv:"Giza 168", YrR:["PstS13"], LrR:["MHT/TT"], SrR:["TTTSK"], loc:"Giza", level:"Moderate"},
{cv:"Gemmeiza 12", YrR:["PstS8"], LrR:["BBG/BN"], SrR:["TRTTF"], loc:"Gharbia", level:"Moderate"},
{cv:"Giza 171", YrR:["PstS2"], LrR:["THT/TT"], SrR:["TTKSK"], loc:"Giza", level:"High"},
{cv:"Sohag 3", YrR:["PstS2","PstS8"], LrR:["BBG/BN"], SrR:["TTTSK"], loc:"Sohag", level:"High"},
{cv:"Sohag 4", YrR:["PstS13"], LrR:["MHT/TT"], SrR:["TTKSK"], loc:"Sohag", level:"High"},
{cv:"Beni Suef 5", YrR:["PstS8"], LrR:["BBG/BN"], SrR:["TRTTF"], loc:"Beni Suef", level:"Moderate"},
{cv:"Beni Suef 7", YrR:["PstS2","PstS13"], LrR:["THT/TT"], SrR:["TTTSK"], loc:"Beni Suef", level:"High"}
];

// Build Unique Dropdown Lists
const Y=[...new Set(DB.flatMap(x=>x.YrR))];
const L=[...new Set(DB.flatMap(x=>x.LrR))];
const S=[...new Set(DB.flatMap(x=>x.SrR))];
const Loc=[...new Set(DB.map(x=>x.loc))];

Y.forEach(x=>Yfilter.innerHTML+=`<option>${x}</option>`);
L.forEach(x=>Lfilter.innerHTML+=`<option>${x}</option>`);
S.forEach(x=>Sfilter.innerHTML+=`<option>${x}</option>`);
Loc.forEach(x=>locationFilter.innerHTML+=`<option>${x}</option>`);

function predict(){
    let Ysel=[...Yfilter.selectedOptions].map(v=>v.value);
    let Lsel=[...Lfilter.selectedOptions].map(v=>v.value);
    let Ssel=[...Sfilter.selectedOptions].map(v=>v.value);
    let Lc=locationFilter.value;

    let res=DB.filter(x=>
        ((Ysel.every(r=>x.YrR.includes(r))) ||
        (Lsel.every(r=>x.LrR.includes(r))) ||
        (Ssel.every(r=>x.SrR.includes(r))) )&&
        (!Lc || x.loc===Lc)
    );

    output.innerHTML=res.length?res.map(r=>`
    <div class='result'>
    <b>${r.cv}</b><br>
    Yr Races: ${r.YrR.join(", ")}<br>
    Lr Races: ${r.LrR.join(", ")}<br>
    Sr Races: ${r.SrR.join(", ")}<br>
    Location: <b>${r.loc}</b> â€” Resistance: <b>${r.level}</b>
    </div>`).join(""):`<em>No matching cultivar found</em>`;
}
</script>
</body>
</html>
